if (self.CavalryLogger) { CavalryLogger.start_js(["2qi5Z"]); }

__d("PagesHomepagePageletUsageTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:PagesHomepagePageletUsageLoggerConfig",this.$PagesHomepagePageletUsageTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:PagesHomepagePageletUsageLoggerConfig",this.$PagesHomepagePageletUsageTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$PagesHomepagePageletUsageTypedLogger1={};return this};h.prototype.updateData=function(j){this.$PagesHomepagePageletUsageTypedLogger1=babelHelpers["extends"]({},this.$PagesHomepagePageletUsageTypedLogger1,j);return this};h.prototype.setAdminMessage=function(j){this.$PagesHomepagePageletUsageTypedLogger1.admin_message=j;return this};h.prototype.setEventName=function(j){this.$PagesHomepagePageletUsageTypedLogger1.event_name=j;return this};h.prototype.setIsEmbedded=function(j){this.$PagesHomepagePageletUsageTypedLogger1.is_embedded=j;return this};h.prototype.setUserMessage=function(j){this.$PagesHomepagePageletUsageTypedLogger1.user_message=j;return this};h.prototype.setVC=function(j){this.$PagesHomepagePageletUsageTypedLogger1.vc=j;return this};var i={admin_message:true,event_name:true,is_embedded:true,user_message:true,vc:true};f.exports=h}),null);
__d("PagesMessagingLoadingRow.react",["cx","React","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(l,m){"use strict";j.constructor.call(this,l,m)}k.prototype.render=function(){"use strict";var l="_5y2c"+(!this.props.useDarkVersion?" _4a7c":"")+(this.props.useDarkVersion?" _4a7d":"");l=c("joinClasses")(l,this.props.className);return c("React").createElement("div",{className:l})};f.exports=k}),null);
__d("PagesMessagingRelativeTimestamp.react",["React","LongLiveTimer"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=1e3;h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;function k(l,m){i.constructor.call(this,l,m);this.state={relativeTime:this.$PagesMessagingRelativeTimestamp1(l.utcTimestamp,l.shouldShorternTime)}}k.prototype.componentWillReceiveProps=function(l){if(l.utcTimestamp!==this.props.utcTimestamp||l.shouldShorternTime!==this.props.shouldShorternTime)this.setState({relativeTime:this.$PagesMessagingRelativeTimestamp1(l.utcTimestamp,l.shouldShorternTime)})};k.prototype.render=function(){return c("React").createElement("div",{className:this.props.className},c("React").createElement("abbr",{className:"livetimestamp","data-utime":this.props.utcTimestamp/j,"data-shorten":this.props.shouldShorternTime},this.state.relativeTime.text))};k.prototype.$PagesMessagingRelativeTimestamp1=function(l,m){return c("LongLiveTimer").renderRelativeTimeToServer(l/j,m)};f.exports=k}),null);
__d("PagesMessageSnippetFetcher",["invariant","immutable","MercuryFilters","MercuryIDs","MercuryPageOrderedThreadlist","MercuryParticipants","MercuryThreadInformer","MercuryThreads","MessagingTag","Random","SubscriptionsHandler","XPagesManagerMessagesController"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("immutable").Map;j.getInboxURI=function(k,l,m){return c("XPagesManagerMessagesController").getURIBuilder().setString("page_token",k).setString("threadid",c("MercuryIDs").getUserIDFromThreadID(l)).setString("ref",m).getURI()};function j(k,l,m,n){__p&&__p();this.$PagesMessageSnippetFetcher3=k;this.$PagesMessageSnippetFetcher1=l;this.$PagesMessageSnippetFetcher2=m;this.$PagesMessageSnippetFetcher5=c("MercuryPageOrderedThreadlist").getForFBID(k);this.$PagesMessageSnippetFetcher6=c("MercuryThreads").getForFBID(k);this.$PagesMessageSnippetFetcher8=c("MercuryThreadInformer").getForFBID(k);this.$PagesMessageSnippetFetcher7=new(c("SubscriptionsHandler"))();this.$PagesMessageSnippetFetcher10();this.$PagesMessageSnippetFetcher4=false;this.$PagesMessageSnippetFetcher9=n}j.prototype.$PagesMessageSnippetFetcher11=function(k){this.$PagesMessageSnippetFetcher7.addSubscriptions(this.$PagesMessageSnippetFetcher8.subscribe(k,function(l,m){return this.fetch()}.bind(this)))};j.prototype.$PagesMessageSnippetFetcher10=function(){this.$PagesMessageSnippetFetcher11("threadlist-updated");this.$PagesMessageSnippetFetcher11("threads-updated");this.$PagesMessageSnippetFetcher11("unread-updated")};j.prototype.fetch=function(){if(this.$PagesMessageSnippetFetcher4)return;this.$PagesMessageSnippetFetcher4=true;this.$PagesMessageSnippetFetcher5.getFilteredThreadlist(0,5,c("MessagingTag").INBOX,c("MercuryFilters").UNREAD,function(k){return this.$PagesMessageSnippetFetcher12(k)}.bind(this))};j.prototype.cleanup=function(){this.$PagesMessageSnippetFetcher7.release()};j.prototype.$PagesMessageSnippetFetcher12=function(k){__p&&__p();if(!k||k.length===0){this.$PagesMessageSnippetFetcher2();this.$PagesMessageSnippetFetcher4=false;return}var l=this.$PagesMessageSnippetFetcher9?k[Math.floor(c("Random").random()*k.length)]:k[0],m=this.$PagesMessageSnippetFetcher6.getThreadMetaNow(l);m||h(0);var n=m.other_user_fbid;n||h(0);var o="fbid:"+n;c("MercuryParticipants").get(o,function(p){this.$PagesMessageSnippetFetcher4=false;m||h(0);this.$PagesMessageSnippetFetcher1({senderImageSrc:p.image_src,senderName:p.name,senderShortName:p.short_name,thread:m,participants:i(c("immutable").Seq(m.participants).map(function(q){return[q,c("MercuryParticipants").getOrFetch(q)]}))})}.bind(this))};f.exports=j}),null);
__d("PagesMessagingHomePageletLogger",["PagesHomepagePageletUsageTypedLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$PagesMessagingHomePageletLogger1=i}h.prototype.$PagesMessagingHomePageletLogger2=function(event,i){var j={is_embedded:this.$PagesMessagingHomePageletLogger1,event_name:event};if(i)j=Object.assign(j,i);var k=new(c("PagesHomepagePageletUsageTypedLogger"))();k.updateData(j).log()};h.prototype.logEvent=function(i){this.$PagesMessagingHomePageletLogger2(i,null)};h.prototype.logEventWithUserMessage=function(i,j){this.$PagesMessagingHomePageletLogger2(i,{user_message:j})};h.prototype.logReplyMessage=function(i,j,k){this.$PagesMessagingHomePageletLogger2(i,{user_message:j,admin_message:k})};f.exports=h}),null);
__d("PagesMessagingHomePageletAction",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CLICK_MESSAGE:"click_message",MARK_ARCHIVE:"mark_archive",MARK_READ:"mark_read",MARK_SPAM:"mark_spam",REPLY_MESSAGE:"reply_message",GO_TO_INBOX:"go_to_inbox",RENDER:"render"})}),null);
__d("PagesMessageSender",["MercuryMessageActions","MercuryMessageObject","MercurySourceType"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j,k,l){this.__senderID=i;this.__threadID=j;this.__messageActions=c("MercuryMessageActions").getForFBID(i);this.__messageObject=c("MercuryMessageObject").getForFBID(i);this.__creatorInfo=l?l:null;this.__pageID=k}h.prototype.__willSendMessage=function(i){};h.prototype.getTargetThreadID=function(){return this.__threadID};h.prototype.sendMessage=function(i){this.__willSendMessage(i);var j=this.__messageObject.constructUserGeneratedMessageObject(i,c("MercurySourceType").TITAN_WEB,this.__threadID,null,this.__creatorInfo);this.__messageActions.send(j)};f.exports=h}),null);
__d("PagesMessagingInboxOverviewMessageProcessor",["MercuryPageThreadActions","PagesMessagingHomePageletAction","PagesMessagingHomePageletLogger","PagesMessageSender","PagesMessagingActionPlacement"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("PagesMessageSender"));i=h&&h.prototype;function j(k,l,m,n){i.constructor.call(this,l,n.thread.thread_id,l,k);this.$PagesMessagingInboxOverviewMessageProcessor1=m;this.$PagesMessagingInboxOverviewMessageProcessor2=n;this.$PagesMessagingInboxOverviewMessageProcessor3=c("MercuryPageThreadActions").getForFBID(l);this.$PagesMessagingInboxOverviewMessageProcessor4=new(c("PagesMessagingHomePageletLogger"))(m)}j.prototype.__willSendMessage=function(k){this.$PagesMessagingInboxOverviewMessageProcessor4.logReplyMessage(c("PagesMessagingHomePageletAction").REPLY_MESSAGE,this.$PagesMessagingInboxOverviewMessageProcessor2.thread.snippet,k);this.markAsRead()};j.prototype.$PagesMessagingInboxOverviewMessageProcessor5=function(k){this.$PagesMessagingInboxOverviewMessageProcessor4.logEventWithUserMessage(k,this.$PagesMessagingInboxOverviewMessageProcessor2.thread.snippet)};j.prototype.$PagesMessagingInboxOverviewMessageProcessor6=function(k){k.call(this.$PagesMessagingInboxOverviewMessageProcessor3,[this.__threadID],c("PagesMessagingActionPlacement").HOME_PAGE_PAGELET_INLINE_ACTION)};j.prototype.markAsSpam=function(){this.$PagesMessagingInboxOverviewMessageProcessor5(c("PagesMessagingHomePageletAction").MARK_SPAM);this.$PagesMessagingInboxOverviewMessageProcessor6(this.$PagesMessagingInboxOverviewMessageProcessor3.batchMarkSpam)};j.prototype.markAsRead=function(){this.$PagesMessagingInboxOverviewMessageProcessor5(c("PagesMessagingHomePageletAction").MARK_READ);this.$PagesMessagingInboxOverviewMessageProcessor6(this.$PagesMessagingInboxOverviewMessageProcessor3.batchMarkRead)};j.prototype.markAsArchive=function(){this.$PagesMessagingInboxOverviewMessageProcessor5(c("PagesMessagingHomePageletAction").MARK_ARCHIVE);this.$PagesMessagingInboxOverviewMessageProcessor6(this.$PagesMessagingInboxOverviewMessageProcessor3.batchArchive)};f.exports=j}),null);
__d("PagesMessagingInboxOverviewPlacement",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({AYMT_HOMEPAGE_PANEL:"aymt_homepage_panel",ADMIN_HOVERCARD:"admin_hovercard",UNKNOWN:"unknown"})}),null);
__d("PagesMessagingMessageSnippet.react",["cx","fbt","Image.react","Layout.react","LeftRight.react","MercuryThreadSnippet.react","PagesMessagingInboxOverviewPlacement","PagesMessagingLoadingRow.react","PagesMessagingRelativeTimestamp.react","React","joinClasses"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=c("Layout.react").Column,m=c("Layout.react").FillColumn;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;n.prototype.render=function(){"use strict";var o=c("joinClasses")("_3sfn",this.props.className);return c("React").createElement("div",{className:o,"data-hover":"tooltip","data-tooltip-content":i._("Click to read and act on the full message."),role:"button"},this.$PagesMessagingMessageSnippet1())};n.prototype.$PagesMessagingMessageSnippet1=function(){"use strict";return c("React").createElement(c("Layout.react"),null,c("React").createElement(l,null,this.$PagesMessagingMessageSnippet2()),c("React").createElement(m,null,this.$PagesMessagingMessageSnippet3()))};n.prototype.$PagesMessagingMessageSnippet2=function(){"use strict";if(!this.props.message)return c("React").createElement(c("PagesMessagingLoadingRow.react"),{className:(this.props.placement===c("PagesMessagingInboxOverviewPlacement").AYMT_HOMEPAGE_PANEL?"_3fep":"")+(this.props.placement===c("PagesMessagingInboxOverviewPlacement").ADMIN_HOVERCARD?" _3feq":"")});return c("React").createElement(c("Image.react"),{className:(this.props.placement===c("PagesMessagingInboxOverviewPlacement").AYMT_HOMEPAGE_PANEL?"_3fep":"")+(this.props.placement===c("PagesMessagingInboxOverviewPlacement").ADMIN_HOVERCARD?" _3feq":""),src:this.props.message?this.props.message.senderImageSrc:""})};n.prototype.$PagesMessagingMessageSnippet3=function(){"use strict";var o=this.props.message;if(!o)return c("React").createElement("div",{className:"_3sfp"},c("React").createElement(c("PagesMessagingLoadingRow.react"),{className:"_3sfq"}),c("React").createElement(c("PagesMessagingLoadingRow.react"),{className:"_3sfr"}));var p=null;if(this.props.placement===c("PagesMessagingInboxOverviewPlacement").ADMIN_HOVERCARD)p=c("React").createElement(c("LeftRight.react"),null,c("React").createElement("div",{className:"_2iz9"},i._("Latest unread message")),c("React").createElement(c("PagesMessagingRelativeTimestamp.react"),{className:"_2iz6",utcTimestamp:o.thread.last_message_timestamp,shouldShorternTime:false}));return c("React").createElement("div",{className:"_3sfp"},p,c("React").createElement("div",{className:(this.props.placement===c("PagesMessagingInboxOverviewPlacement").AYMT_HOMEPAGE_PANEL?"_3fer":"")+(this.props.placement===c("PagesMessagingInboxOverviewPlacement").ADMIN_HOVERCARD?" _3fes":"")+" _3sg9"},o.senderName),c("React").createElement(c("MercuryThreadSnippet.react"),{className:"_3sga _3sg9",participants:o.participants,shouldRenderYou:false,thread:o.thread,viewer:this.props.pageID}))};function n(){"use strict";j.apply(this,arguments)}f.exports=n}),null);
__d("PagesMessagingInboxOverview.react",["cx","invariant","fbt","LeftRight.react","Link.react","MercurySyncPageEnvironment","PagesMessageSnippetFetcher","PagesMessagingHomePageletAction","PagesMessagingHomePageletLogger","PagesMessagingInboxOverviewMessageProcessor","PagesMessagingInboxOverviewPlacement","PagesMessagingMessageSnippet.react","PagesMessagingRelativeTimestamp.react","React"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l;k=babelHelpers.inherits(m,c("React").Component);l=k&&k.prototype;function m(n,o){l.constructor.call(this,n,o);this.$PagesMessagingInboxOverview1=this.$PagesMessagingInboxOverview4(n.pageInfo,n.showRandomMessage);this.$PagesMessagingInboxOverview3=new(c("PagesMessagingHomePageletLogger"))(true);this.state={lastUnreadMessage:null,replyMessage:"",noMoreMessage:false}}m.prototype.componentWillUMount=function(){c("MercurySyncPageEnvironment").setUp(this.props.pageInfo.id.toString(),this.props.pageInfo.syncSequenceID)};m.prototype.componentDidMount=function(){this.$PagesMessagingInboxOverview1.fetch();this.$PagesMessagingInboxOverview3.logEvent(c("PagesMessagingHomePageletAction").RENDER)};m.prototype.componentWillUnmount=function(){c("MercurySyncPageEnvironment").tearDown(this.props.pageInfo.id.toString());this.$PagesMessagingInboxOverview1.cleanup()};m.prototype.componentWillReceiveProps=function(n){if(n.pageInfo!==this.props.pageInfo){this.setState({lastUnreadMessage:null});this.$PagesMessagingInboxOverview1=this.$PagesMessagingInboxOverview4(n.pageInfo,n.showRandomMessage);this.$PagesMessagingInboxOverview1.fetch()}};m.prototype.render=function(){__p&&__p();if(this.state.noMoreMessage)return null;var n=null;if(this.state.noMoreMessage)n=this.$PagesMessagingInboxOverview5();else{var o=this.state.lastUnreadMessage;if(o)n=this.$PagesMessagingInboxOverview6(o);else n=this.$PagesMessagingInboxOverview7()}return c("React").createElement("div",{className:this.props.className},n)};m.prototype.$PagesMessagingInboxOverview8=function(){var n=this.state.lastUnreadMessage;this.$PagesMessagingInboxOverview2&&n&&this.$PagesMessagingInboxOverview2.getTargetThreadID()===n.thread.thread_id||i(0)};m.prototype.$PagesMessagingInboxOverview4=function(n,o){return new(c("PagesMessageSnippetFetcher"))(n.id.toString(),function(p){return this.$PagesMessagingInboxOverview9(p)}.bind(this),function(){return this.$PagesMessagingInboxOverview10()}.bind(this),o)};m.prototype.$PagesMessagingInboxOverview9=function(n){this.setState({lastUnreadMessage:n,noMoreMessage:false},function(){this.$PagesMessagingInboxOverview2=new(c("PagesMessagingInboxOverviewMessageProcessor"))(this.props.pageInfo.creatorInfo,this.props.pageInfo.id,true,n)}.bind(this))};m.prototype.$PagesMessagingInboxOverview10=function(){this.setState({noMoreMessage:true})};m.prototype.$PagesMessagingInboxOverview11=function(n){if(n.key==="Enter"&&this.state.replyMessage.length>0){this.$PagesMessagingInboxOverview8();this.$PagesMessagingInboxOverview2.sendMessage(this.state.replyMessage);this.setState({replyMessage:""})}};m.prototype.$PagesMessagingInboxOverview5=function(){return c("React").createElement("div",{className:"_4c40"},j._("No more unread messages"))};m.prototype.$PagesMessagingInboxOverview7=function(){return c("React").createElement(c("PagesMessagingMessageSnippet.react"),{className:"_2iza _12f2",message:this.state.lastUnreadMessage,pageID:this.props.pageInfo.id,placement:this.props.placement})};m.prototype.$PagesMessagingInboxOverview12=function(n){return c("PagesMessageSnippetFetcher").getInboxURI(this.props.pageInfo.uriToken,n.thread.thread_id,this.props.placement)};m.prototype.$PagesMessagingInboxOverview6=function(n){var o=null;if(this.props.placement===c("PagesMessagingInboxOverviewPlacement").AYMT_HOMEPAGE_PANEL)o=c("React").createElement(c("LeftRight.react"),null,c("React").createElement("div",{className:"_2iz9"},j._("Latest unread message")),c("React").createElement(c("PagesMessagingRelativeTimestamp.react"),{className:"_2iz6",utcTimestamp:n.thread.last_message_timestamp,shouldShorternTime:false}));return c("React").createElement(c("Link.react"),{className:"_2hlr",href:this.$PagesMessagingInboxOverview12(n)},o,c("React").createElement(c("PagesMessagingMessageSnippet.react"),{className:"_2iza",message:n,pageID:this.props.pageInfo.id,placement:this.props.placement}))};f.exports=m}),null);
__d("PagesMessagingInlineInboxView.react",["PagesMessagingInboxOverview.react","React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement(c("PagesMessagingInboxOverview.react"),{pageInfo:this.props.pageInfo,showRandomMessage:this.props.showRandomMessage,placement:this.props.placement})};function j(){h.apply(this,arguments)}f.exports=j}),null);